# 异步基础知识

## 基本概念

在发起请求时，我们很多时候会用到异步， 如 `AJAX` 请求。

在学习的时候我们经常使用 `setTimeout` 来模拟延时的异步操作。当然它也是一个异步函数，就算延时时间是 `0(最少默认是 4ms)`，也是异步的



## 异步和同步的区别

假设 `pro` 是同步方法

```js
// 这3个方法会按照顺序执行
por1()
por2()
por3()
```



假设 `ajax` 是异步方法

```js
// 这3个方法的执行顺序是不一定的，因为是异步的操作
ajax1()
ajax2()
ajax3()
```



## 异步带来的问题

### 无法同步取值

> 多个异步操作的执行顺序是不定的。那么就无法用同步的方式去获取值

```js
// 这种方式是获取不到值的，因为当执行到这步的时候，ajax()还没有执行完
// 等ajax执行完了，这步早就走完了，那么变量 data 自然就没有值。
const data = ajax()
```



### 无法动态渲染 DOM

> 在用到一些框架时，用 ajax 方式请求数据，赋值后想要更新 DOM 视图。但是你不知道 DOM 到底什么时候渲染的

#### 方法在 DOM 渲染之前

那这一般来说就是操作数据，而请求数据的方式中很多情况下就是异步请求。—— `onLoad` 钩子函数z

- 这种情况下，我们需要在多个函数之间传递获取的数据该怎么办呢？解决方案之一就是使用回调函数
- 我们只能在异步请求回调中去使用数据

```js
// 请求方法
http:function(url , callback) {
  // 请求成功时的回调
  success(res) { callback(res.data) }
}
// 事先定义好回调函数
callback: function(data) {
  log(data) // 这里能够使用到我们的数据
}
```



#### 方法在 DOM 渲染之后

这一般来说就是往已经存在的 DOM 上去填充数据。——`onReady` 钩子函数

- 这种情况下，我们需要提前声明一些 DOM 需要用到的变量。即使是空的。
- 在异步的情况下，DOM 先行渲染完毕，要用到变量时，却发现没有，会报错。如果我们事先提供了这些数据，然后DOM就会先用上这些数据。
- 最后，在异步执行完毕后，我们会使用框架的数据绑定，去响应这些DOM上的变量，从而展示出数据

