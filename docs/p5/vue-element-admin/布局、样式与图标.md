# 样式与图标

## 样式选中

### 父子组件样式选中（深度选择器>>>）

```css
.father >>> .son {}

// 如果是 sass 用 /deep/
.father /deep/ .son {}
```

### 增加父 div 命名空间

```css
/*包裹一层 div*/
.father {
	/*更改目标 elm 的组件样式*/
	.e-tag { }
}
```





## SVG 图标使用

### 传统的icon 用法

> 当然图标来源都是 阿里矢量图标库


传统的做法就是`图标字体`（字体文件+字体样式），不方便维护。

因为增加图标，每次都需要重新生成文件。

### svg 方案（svg-sprite-loader）

使用 `svg-sprite-loader`自动加载打包，方便维护。

> 就是指定一个目录，之后把该目录下的 SVG 统一打包


- 安装依赖

```
npm i svg-sprite-loader -D
```

- 下载图标，放入 src/icons/svg 目录中

这个目录是自定义的，但是一般都是这样的路径。下载的图标是 svg 格式，之后放到上面的目录中就行。之后我们通过 loader 配置去管理打包



### 配置 vue.config.js

- 先排除默认的 svg 相关 loader

> 在此之前需要知道 ，对 svg 已经有默认的 loader 被配置了。
> 通过 `vue inspect --rules svg`可以看到该配置。是对所有 svg 格式文件的管理。
> 所以要先把这个loader对我们专门用于存放 svg 图标的目录排除掉。



### webpack 的链式配置 chainWebpack

> `chainWebpack(config){}` 是一个函数，传入了配置参数


```javascript
// vue.config.js
// 1 获取绝对路径
const path = require('path')
// 将相对路径转为绝对路径的函数
function resolve(dir) {
  return path.join(__dirname, dir)
}

module.exports = {
  //...
  // 2 高级链式配置
  // config 中有个重要的字段就是用于配置 loader 的 module
  chainWebpack(config) {
    // 3 配置 svg 规则，先去排除 icons 目录
    config.module.rule('svg')
    	.exclude.add(resolve('src/icons')) // 3.1 排除 icons 目录
    	.end(); // 相当于是链式操作中返回上一级的行为。这里是结束语句，不用也行
    
    // 4 新增 icons 规则，设置 svg-sprite-loader
    // 每一个 rule 都要对应一个 Loader
    config.module.rule('icons') // 4.1 创建 icons 规则
    	.test(/\.svg$/) // 4.2 匹配 svg 文件
    	.include.add(resolve('src/icons')) // 4.3 只考虑 icons 目录
    	.end() // 跳出对该规则的深层级配置
    	.use('svg-sprite-loader') // 4.4 使用该规则
    	.loader('svg-sprite-loader') // 4.5 并找到对应的 loader
    	// 4.6 配置该 loader 选项, 就是之后要使用的 icon 名称,如 icon-xxx
    	.options({ symbolId: 'icon-[name]' }) 
    	.end()
  }
}
```



### 图标自动导入配置

> 目前可以在 vue 组件中使用，不过对每个图标需要单独使用 `import` 去导入，然后用 `<svg>` 去使用。


- 新建 src/icons/index.js

```javascript
// src/icons/index.js
// 1 通过 require.context 设置匹配规则，圈定范围
// 参数1：自动导入的目录（上下文）； 参数2：没有子目录了； 参数3：匹配文件格式
const req = require.context("./svg", false, /\.svg$/)
// 2 拿出所有的图标
// req.keys() 相当于是拿出了所有图标的数组, ['qq.svg', 'wx.svg']
req.keys().map(req)
```

- 在 src/main.js 中引入

```javascript
import './icons'
```

- 直接使用 svg

> 这里就直接使用了 `icon-qq` 这个图标。
> 渲染后以后，HTML 实际展示的是一个 `symbol`标签


```html
<svg><use xlink:href="#icon-qq" /></svg>
```

- 矢量图 svg 的好处

随便缩放，颜色随便改



### 封装组件方便使用

- 二次封装这个 SVG 图标

去 `components`目录下新建 `SvgIcon`组件

```vue
<template>
	<svg :class="svgClass" aria-hidden="true" v-on="$listeners">
  	<use :xlink:href="iconName" />
  </svg>
</template>

<script>
  export default {
    name: 'SvgIcon',
    props: {
      // 图标的名字， 指定具体的图标
      iconClass: {
        type: String,
        required: true
      },
      // 用于指定类名，约束该图标的样式
      className: {
        type: String,
        default: ''
      }
    },
    computed: {
      // 响应 iconClass 的计算属性
      iconName() {
        return `#icon-${this.iconClass}`
      },
      // 响应 className 的计算属性
      svgClass() {
        if (this.className) {
          return 'svg-icon ' + this.className
        } else {
          return 'svg-icon'
        }
      }
    }
  }
</script>

<style scoped>
  /* 预定义的图标样式 */
  .svg-icon {
    width: 1em;
    height: 1em;
    vertical-align: -0.15em;
    fill: currentColor;
    overflow: hidden;
  }
</style>
```

- 去 src/icons/index.js 中全局引入该组件

```javascript
// src/icons/index.js
// 全局引入SvgIcon组件
import Vue from 'vue'
import SvgIcon from '@/components/SvgIcon.vue'
Vue.component('svg-icon', SvgIcon)

const req = require.context("./svg", false, /\.svg$/)
req.keys().map(req)
```

- 去任意组件中直接使用

```html
<svg-icon icon-class="qq"></svg-icon>
```
