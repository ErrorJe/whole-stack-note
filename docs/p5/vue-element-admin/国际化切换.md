# 国际化切换

切换也比较简单，就是在根组件，引入不同的语言包且注册就行了。

> 还有一个库 `Vue I18n` 是国家化的专用插件


## antd-vue库的国际化



### 入口文件引入组件

提供了一个 `LocaleProvider`全局组件，用于切换国际化文案。默认是英文的

```javascript
// main.js
// 1 引入该组件
import {Button, LocaleProvider} from 'ant-design-vue'

// 2 插件形式注册
Vue.use(LocaleProvider)
```



### 根组件使用

```vue
<template>
<div id="app">
  <a-locale-provider :locale="locale">
    <App />
  </a-locale-provider>
  <router-view />
  </div>
</template>

<script>
	// 1 导入中文包和英文包
  import zhCN from 'ant-design-vue/lib/locale-provider/zh_CN';
  import enUS from 'ant-design-vue/lib/locale-provider/en_US';
  // 4 moment 库也需要语言切换，因为程序用到了
  import moment from 'moment'
  export default {
    // 2 响应式变量
    data() {
      return {
        locale: zhCN,
      }
    },
    // 3 监听路由去切换语言
    watch:{
      "$route.query.locale":function(val){
        this.locale = val === 'enUS' ? enUS : zhCN
        moment.locale(val === 'enUS' ? 'en' : 'zh-cn')
      }
    }
  }
</script>
```



### 其他组件中实现切换

```javascript
// 假设使用了 a-menu-item 组件且他们的 key 属性分别是 zhCN , enUS
localeChange({key}){
  this.$router.push({query:{...this.$route.query, locale:key}})
}
```



## 使用 Vue-I18n 国际化插件



### 安装

基于 vue-cli3 直接以插件形式注入

`vue add i18n`



### 引入

按照 vue add 的方式，一般会在 main.js 自动引入。

如果是 Npm 安装方式，则需要手动引入`import VueI18n from 'vue-i18n'`



### 应用



#### 建立自定义的语言包文件

> 可以在项目开发时，对一些没有完善语言切换的内容进行动态替换.


创建 src/locale/zhCN.js 和 src/locale/enUS.js

```javascript
// src/locale/zhCN.js
export default {
  // 名字随便取，最好长一点，避免重名
  "app.dashboard.analysis.timeLable":"时间"
}

// src/locale/enUS.js
export default {
  "app.dashboard.analysis.timeLable":"Time"
}
```



#### main.js 导入语言包

```javascript
import VueI18n from 'vue-i18n
import zhCN from './locale/zhCN.js'
import enUS from './locale/enUS.js'
import queryString from 'query-string' // 解析 URL 字符串

// 注册
Vue.use(VueI18n)

// 实例化
const il8n = new VueI18n({
  locale:queryString.parse(locale.search).locale || 'zhCN',
  messages:{
    zhCN:{message:zhCN},
    enUS:{message:enUS}
  }
})

// 传递 il8n 选项到 vue 实例
new Vue({
  il8n,
  router,
  store,
  render:h=>h(App)
}).$mount('#app')
```



#### 组件中使用

用 `$t` 去拿到值

```vue
<div>
  {{ $t('message')['app.dashboard.analysis.timeLable'] }}
</div>
```

在更改 locale 的方法中加入相应逻辑

```javascript
// 假设使用了 a-menu-item 组件且他们的 key 属性分别是 zhCN , enUS
localeChange({key}){
  this.$router.push({query:{...this.$route.query, locale:key}})
  this.$il8n.locale = key
}
```
