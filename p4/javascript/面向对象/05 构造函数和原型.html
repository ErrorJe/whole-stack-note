<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构造函数和原型对象 | FE 前端研究所</title>
    <meta name="description" content="ErrorJE 直辖 Blog | FE 前端研究所">
    <link rel="icon" href="/whole-stack-note/logo.jpg">
  <link rel="manifest" href="/whole-stack-note/manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    
    <link rel="preload" href="/whole-stack-note/assets/css/0.styles.e45b6d8e.css" as="style"><link rel="preload" href="/whole-stack-note/assets/js/app.a3debe68.js" as="script"><link rel="preload" href="/whole-stack-note/assets/js/2.e13c0dfc.js" as="script"><link rel="preload" href="/whole-stack-note/assets/js/51.37619b9e.js" as="script"><link rel="preload" href="/whole-stack-note/assets/js/4.006c3239.js" as="script"><link rel="prefetch" href="/whole-stack-note/assets/js/10.5080ced0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/100.acc12b55.js"><link rel="prefetch" href="/whole-stack-note/assets/js/101.703df793.js"><link rel="prefetch" href="/whole-stack-note/assets/js/102.aea63913.js"><link rel="prefetch" href="/whole-stack-note/assets/js/103.52fd9c93.js"><link rel="prefetch" href="/whole-stack-note/assets/js/11.cec1ebb3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/12.4b2a03c7.js"><link rel="prefetch" href="/whole-stack-note/assets/js/13.30948cab.js"><link rel="prefetch" href="/whole-stack-note/assets/js/14.b5861d17.js"><link rel="prefetch" href="/whole-stack-note/assets/js/15.b3fe6a46.js"><link rel="prefetch" href="/whole-stack-note/assets/js/16.b54c7eec.js"><link rel="prefetch" href="/whole-stack-note/assets/js/17.48d93c34.js"><link rel="prefetch" href="/whole-stack-note/assets/js/18.0c526b42.js"><link rel="prefetch" href="/whole-stack-note/assets/js/19.9da136a0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/20.fc0cc2de.js"><link rel="prefetch" href="/whole-stack-note/assets/js/21.323ba669.js"><link rel="prefetch" href="/whole-stack-note/assets/js/22.c781e4b3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/23.76a1b2a0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/24.0bc4974b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/25.f34dad9d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/26.01d63dde.js"><link rel="prefetch" href="/whole-stack-note/assets/js/27.5ed8ffac.js"><link rel="prefetch" href="/whole-stack-note/assets/js/28.79087a03.js"><link rel="prefetch" href="/whole-stack-note/assets/js/29.d0ee654e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/3.7611bd43.js"><link rel="prefetch" href="/whole-stack-note/assets/js/30.d2bfcc51.js"><link rel="prefetch" href="/whole-stack-note/assets/js/31.3dacf949.js"><link rel="prefetch" href="/whole-stack-note/assets/js/32.6bd49ece.js"><link rel="prefetch" href="/whole-stack-note/assets/js/33.dec9ad8a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/34.7bad766d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/35.e0cd51ea.js"><link rel="prefetch" href="/whole-stack-note/assets/js/36.43d6fb08.js"><link rel="prefetch" href="/whole-stack-note/assets/js/37.acc7b80e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/38.272e2e72.js"><link rel="prefetch" href="/whole-stack-note/assets/js/39.ddfe027f.js"><link rel="prefetch" href="/whole-stack-note/assets/js/40.3a01b9ab.js"><link rel="prefetch" href="/whole-stack-note/assets/js/41.3c826b49.js"><link rel="prefetch" href="/whole-stack-note/assets/js/42.f901dd74.js"><link rel="prefetch" href="/whole-stack-note/assets/js/43.47a97e97.js"><link rel="prefetch" href="/whole-stack-note/assets/js/44.aea411c3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/45.c8e69799.js"><link rel="prefetch" href="/whole-stack-note/assets/js/46.2066af0c.js"><link rel="prefetch" href="/whole-stack-note/assets/js/47.486093d6.js"><link rel="prefetch" href="/whole-stack-note/assets/js/48.fea3089b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/49.9e1bf2f1.js"><link rel="prefetch" href="/whole-stack-note/assets/js/5.353e6219.js"><link rel="prefetch" href="/whole-stack-note/assets/js/50.d959c541.js"><link rel="prefetch" href="/whole-stack-note/assets/js/52.c6eeddd2.js"><link rel="prefetch" href="/whole-stack-note/assets/js/53.777f1a99.js"><link rel="prefetch" href="/whole-stack-note/assets/js/54.3a928b8b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/55.da530c09.js"><link rel="prefetch" href="/whole-stack-note/assets/js/56.1dfb41b8.js"><link rel="prefetch" href="/whole-stack-note/assets/js/57.216959fc.js"><link rel="prefetch" href="/whole-stack-note/assets/js/58.a0758c48.js"><link rel="prefetch" href="/whole-stack-note/assets/js/59.5ce91a2d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/6.c96f94a6.js"><link rel="prefetch" href="/whole-stack-note/assets/js/60.7b906567.js"><link rel="prefetch" href="/whole-stack-note/assets/js/61.42f0cd41.js"><link rel="prefetch" href="/whole-stack-note/assets/js/62.72627354.js"><link rel="prefetch" href="/whole-stack-note/assets/js/63.8cf84f66.js"><link rel="prefetch" href="/whole-stack-note/assets/js/64.4148eacd.js"><link rel="prefetch" href="/whole-stack-note/assets/js/65.ad7bcf11.js"><link rel="prefetch" href="/whole-stack-note/assets/js/66.41628c42.js"><link rel="prefetch" href="/whole-stack-note/assets/js/67.fa91107d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/68.e7a6771a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/69.adb07a76.js"><link rel="prefetch" href="/whole-stack-note/assets/js/7.c6dd592b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/70.883e83a8.js"><link rel="prefetch" href="/whole-stack-note/assets/js/71.04c8b4ca.js"><link rel="prefetch" href="/whole-stack-note/assets/js/72.2888e9b0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/73.c6bb9dfa.js"><link rel="prefetch" href="/whole-stack-note/assets/js/74.650ae344.js"><link rel="prefetch" href="/whole-stack-note/assets/js/75.03556209.js"><link rel="prefetch" href="/whole-stack-note/assets/js/76.92302603.js"><link rel="prefetch" href="/whole-stack-note/assets/js/77.06ffc25a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/78.2433a431.js"><link rel="prefetch" href="/whole-stack-note/assets/js/79.3506d106.js"><link rel="prefetch" href="/whole-stack-note/assets/js/8.18958710.js"><link rel="prefetch" href="/whole-stack-note/assets/js/80.b01ec45a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/81.58c7dc94.js"><link rel="prefetch" href="/whole-stack-note/assets/js/82.27922683.js"><link rel="prefetch" href="/whole-stack-note/assets/js/83.6d434690.js"><link rel="prefetch" href="/whole-stack-note/assets/js/84.164af512.js"><link rel="prefetch" href="/whole-stack-note/assets/js/85.c0a4b83c.js"><link rel="prefetch" href="/whole-stack-note/assets/js/86.c1a820c9.js"><link rel="prefetch" href="/whole-stack-note/assets/js/87.06bfdf33.js"><link rel="prefetch" href="/whole-stack-note/assets/js/88.a88abf23.js"><link rel="prefetch" href="/whole-stack-note/assets/js/89.2f15869a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/9.dafc73ec.js"><link rel="prefetch" href="/whole-stack-note/assets/js/90.9e02f225.js"><link rel="prefetch" href="/whole-stack-note/assets/js/91.92f33ca4.js"><link rel="prefetch" href="/whole-stack-note/assets/js/92.72b24c0e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/93.65956fda.js"><link rel="prefetch" href="/whole-stack-note/assets/js/94.cd96b01b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/95.f9417ba0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/96.74b47339.js"><link rel="prefetch" href="/whole-stack-note/assets/js/97.0a771bb2.js"><link rel="prefetch" href="/whole-stack-note/assets/js/98.77ae86f0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/99.09bcc662.js">
    <link rel="stylesheet" href="/whole-stack-note/assets/css/0.styles.e45b6d8e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/whole-stack-note/" class="home-link router-link-active"><!----> <span class="site-name">FE 前端研究所</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/whole-stack-note/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端初级" class="dropdown-title"><span class="title">前端初级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>HTML / CSS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-base/" class="nav-link">HTML 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-pro/" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-base/" class="nav-link">CSS 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-pro/" class="nav-link">CSS3 / CSS4</a></li></ul></li><li class="dropdown-item"><h4>JS 基础与进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/javascript/" class="nav-link router-link-active">JavaScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/es-next/01 let 变量和 const 常量.html" class="nav-link">ES-Next</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/typescript/00 基础知识.html" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/jquery/" class="nav-link">JQuery</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/browser/DOM.html" class="nav-link">浏览器原理</a></li></ul></li><li class="dropdown-item"><h4>项目包管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/npm/" class="nav-link">NPM</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/yarn/" class="nav-link">YARN</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/learn/" class="nav-link">LEARN</a></li></ul></li><li class="dropdown-item"><h4>团队协作</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/code-format/" class="nav-link">代码规范</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/tools/" class="nav-link">开发工具链</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端中级" class="dropdown-title"><span class="title">前端中级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>移动端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/h5/" class="nav-link">H5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/uni-app/" class="nav-link">Uni-App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/react-native/" class="nav-link">React Native</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/fullter/" class="nav-link">Fullter</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/wechat/" class="nav-link">微信小程序</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/weex/" class="nav-link">Weex</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/mpvue/" class="nav-link">MpVue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/pwa/" class="nav-link">PWA</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/native-app/" class="nav-link">Native App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/hybird-app/" class="nav-link">Hybird App</a></li></ul></li><li class="dropdown-item"><h4>开发框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-base/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-element-admin/" class="nav-link">Vue-Element-Admin</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/react-base/" class="nav-link">React</a></li></ul></li><li class="dropdown-item"><h4>NodeJS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/node-base/" class="nav-link">Node 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/express.html" class="nav-link">Express</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/koa.html" class="nav-link">Koa</a></li></ul></li><li class="dropdown-item"><h4>面试相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/business/" class="nav-link">业务开发</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/topic/" class="nav-link">面试题</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/live/" class="nav-link">记录</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/economics/" class="nav-link">经济学</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/growth/" class="nav-link">程序员成长</a></li></ul></div></div><div class="nav-item"><a href="/whole-stack-note/my-resume.html" class="nav-link">Resume</a></div> <a href="https://github.com/ErrorJe/whole-stack-note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/whole-stack-note/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端初级" class="dropdown-title"><span class="title">前端初级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>HTML / CSS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-base/" class="nav-link">HTML 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-pro/" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-base/" class="nav-link">CSS 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-pro/" class="nav-link">CSS3 / CSS4</a></li></ul></li><li class="dropdown-item"><h4>JS 基础与进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/javascript/" class="nav-link router-link-active">JavaScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/es-next/01 let 变量和 const 常量.html" class="nav-link">ES-Next</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/typescript/00 基础知识.html" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/jquery/" class="nav-link">JQuery</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/browser/DOM.html" class="nav-link">浏览器原理</a></li></ul></li><li class="dropdown-item"><h4>项目包管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/npm/" class="nav-link">NPM</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/yarn/" class="nav-link">YARN</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/learn/" class="nav-link">LEARN</a></li></ul></li><li class="dropdown-item"><h4>团队协作</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/code-format/" class="nav-link">代码规范</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/tools/" class="nav-link">开发工具链</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端中级" class="dropdown-title"><span class="title">前端中级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>移动端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/h5/" class="nav-link">H5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/uni-app/" class="nav-link">Uni-App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/react-native/" class="nav-link">React Native</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/fullter/" class="nav-link">Fullter</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/wechat/" class="nav-link">微信小程序</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/weex/" class="nav-link">Weex</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/mpvue/" class="nav-link">MpVue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/pwa/" class="nav-link">PWA</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/native-app/" class="nav-link">Native App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/hybird-app/" class="nav-link">Hybird App</a></li></ul></li><li class="dropdown-item"><h4>开发框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-base/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-element-admin/" class="nav-link">Vue-Element-Admin</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/react-base/" class="nav-link">React</a></li></ul></li><li class="dropdown-item"><h4>NodeJS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/node-base/" class="nav-link">Node 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/express.html" class="nav-link">Express</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/koa.html" class="nav-link">Koa</a></li></ul></li><li class="dropdown-item"><h4>面试相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/business/" class="nav-link">业务开发</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/topic/" class="nav-link">面试题</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/live/" class="nav-link">记录</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/economics/" class="nav-link">经济学</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/growth/" class="nav-link">程序员成长</a></li></ul></div></div><div class="nav-item"><a href="/whole-stack-note/my-resume.html" class="nav-link">Resume</a></div> <a href="https://github.com/ErrorJe/whole-stack-note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/whole-stack-note/p4/javascript/" class="sidebar-link">JS 历史和介绍</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>数据类型</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/whole-stack-note/p4/javascript/数据类型/00 数据类型.html" class="sidebar-link">JS 数据类型</a></li><li><a href="/whole-stack-note/p4/javascript/数据类型/01 数据类型判断.html" class="sidebar-link">数据类型判断</a></li><li><a href="/whole-stack-note/p4/javascript/数据类型/02 数据类型转换.html" class="sidebar-link">数据类型转换</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>执行机制</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/whole-stack-note/p4/javascript/执行机制/01 事件机制.html" class="sidebar-link">事件机制</a></li><li><a href="/whole-stack-note/p4/javascript/执行机制/02 作用域.html" class="sidebar-link">作用域</a></li><li><a href="/whole-stack-note/p4/javascript/执行机制/03 内存管理.html" class="sidebar-link">内存管理</a></li><li><a href="/whole-stack-note/p4/javascript/执行机制/04 闭包.html" class="sidebar-link">闭包</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>堆栈内存和作用域</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/whole-stack-note/p4/javascript/堆栈内存和作用域/堆栈内存.html" class="sidebar-link">堆栈内存机制</a></li><li><a href="/whole-stack-note/p4/javascript/堆栈内存和作用域/作用域.html" class="sidebar-link">作用域和执行上下文</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>面向对象</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/whole-stack-note/p4/javascript/面向对象/01 面向对象基础.html" class="sidebar-link">面向对象基础</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/02 原始类型和引用对象.html" class="sidebar-link">原始类型和引用对象</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/03 函数.html" class="sidebar-link">函数</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/04 对象.html" class="sidebar-link">理解对象</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html" class="active sidebar-link">构造函数和原型对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#构造函数" class="sidebar-link">构造函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#new-操作符" class="sidebar-link">new 操作符</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#构造函数属性-constructor" class="sidebar-link">构造函数属性 constructor</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#私有变量" class="sidebar-link">私有变量</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#构造函数与原型对象的关系" class="sidebar-link">构造函数与原型对象的关系</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#方法为什么要写在原型上" class="sidebar-link">方法为什么要写在原型上</a></li></ul></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#原型和原型对象" class="sidebar-link">原型和原型对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#基本属性和-api" class="sidebar-link">基本属性和 API</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#instanceof-鉴别对象原型" class="sidebar-link">instanceof  鉴别对象原型</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#hasprototypeproperty-鉴别原型属性" class="sidebar-link">hasPrototypeProperty 鉴别原型属性</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#prototype-属性" class="sidebar-link">[[Prototype]] 属性</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#在构造函数中使用原型对象" class="sidebar-link">在构造函数中使用原型对象</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#改变原型对象" class="sidebar-link">改变原型对象</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#内建对象的原型对象" class="sidebar-link">内建对象的原型对象</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#js-和-java-的区别" class="sidebar-link">JS 和 JAVA 的区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#原型链机制" class="sidebar-link">原型链机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#类和实例对象" class="sidebar-link">类和实例对象</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#原型对象" class="sidebar-link">原型对象</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p4/javascript/面向对象/05 构造函数和原型.html#原型链机制-2" class="sidebar-link">原型链机制</a></li></ul></li></ul></li><li><a href="/whole-stack-note/p4/javascript/面向对象/06 继承方案.html" class="sidebar-link">继承方案</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/07 对象模式.html" class="sidebar-link">对象模式</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/08 this 关键字.html" class="sidebar-link">THIS 关键字</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/09 this 内置函数.html" class="sidebar-link">call, apply 和 bind</a></li><li><a href="/whole-stack-note/p4/javascript/面向对象/10 this 应用实例.html" class="sidebar-link">THIS 应用实例</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>异步编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/whole-stack-note/p4/javascript/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/" class="sidebar-link">异步基础知识</a></li><li><a href="/whole-stack-note/p4/javascript/异步编程/高阶函数.html" class="sidebar-link">高阶函数与 AOP</a></li><li><a href="/whole-stack-note/p4/javascript/异步编程/异步解决方案.html" class="sidebar-link">异步解决方案总结</a></li><li><a href="/whole-stack-note/p4/javascript/异步编程/Promise 核心.html" class="sidebar-link">Promise 核心应用</a></li><li><a href="/whole-stack-note/p4/javascript/异步编程/Event Loop.html" class="sidebar-link">Event Loop</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="构造函数和原型对象"><a href="#构造函数和原型对象" class="header-anchor">#</a> 构造函数和原型对象</h1> <p>JS 缺少类（至少 ES6 之前是这样），利用<code>构造函数</code>和<code>原型对象</code>给对象带来与类相似的功能，但不完全一致。</p> <h2 id="构造函数"><a href="#构造函数" class="header-anchor">#</a> 构造函数</h2> <blockquote><p>就是用 new 创建对象时调用的函数。</p> <p>用一个构造函数创建的实例都拥有同样的属性和方法。这也是使用它的原因。</p> <p>行业约定构造函数首字母大写，就跟私有变量约定首字符为 <code>_</code>  一样</p></blockquote> <h3 id="new-操作符"><a href="#new-操作符" class="header-anchor">#</a> new 操作符</h3> <p>通过<code>new</code>调用构造函数创建的 100 个对象实例，独立拥有 100 套变量和方法。这在一些场景显然内存开销过大。我们就要通过原型对象去创建一些共享的变量和方法。</p> <h4 id="普通函数执行过程"><a href="#普通函数执行过程" class="header-anchor">#</a> 普通函数执行过程</h4> <ul><li>创建该函数的<code>执行上下文</code></li> <li>先拿到 <code>fn</code> 的私有属性 <code>arguments</code> 并且赋值得到 <code>[100]</code></li> <li>然后给形参进行赋值 <code>x = 100</code></li></ul> <p>到此为止，都是函数默认的行为，后面才开始执行内部代码</p> <ul><li>声明局部（let 作用域限制在函数内，所以没有变量提升），<code>y = 200</code></li> <li>此时因为是直接执行的 fn 函数，所以 <code>this</code> 指向的是 <code>window</code>，也就是 <code>window.x = x = 100</code></li> <li>最后该函数没有 <code>return</code> 东西，默认返回了 <code>undefined</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">200</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
<span class="token punctuation">}</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre></div><h4 id="new-执行原理"><a href="#new-执行原理" class="header-anchor">#</a> new 执行原理</h4> <p><code>new</code> 操作符自动创建给定类型的对象并返回</p> <p>这些实例都独立拥有构造函数的变量和方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 可以声明一些变量和方法</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token operator">||</span> <span class="token string">'wjy'</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  
  <span class="token comment">// 若这里显式 return 了一个对象，则会返回该对象。return 原始类型是无效的</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建对象</span>
<span class="token comment">// 没有参数传入时，可以省略括号</span>
<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">;</span> 
<span class="token comment">// 被创建的实例拥有原来在构造函数中的变量和方法</span>
obj1<span class="token punctuation">.</span>name <span class="token comment">// 'wjy'</span>
obj1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

obj1 <span class="token keyword">instanceof</span> <span class="token class-name">Fn</span> <span class="token comment">// true</span>
</code></pre></div><h5 id="new-原理"><a href="#new-原理" class="header-anchor">#</a> new 原理</h5> <p>若不用 <code>new</code> 调用构造函数，那么原本构造函数中的 this 都是指向全局的，容易出现错误。</p> <ul><li>new 首先将普通函数作为<code>类</code> 来执行，返回当前类的<code>实例</code> （对象类型）</li> <li>也是先创建函数创建新的 <code>执行上下文</code></li> <li>执行与普通函数执行一样的行为</li></ul> <p>到此为止，跟普通函数执行没有什么区别，接下来 <code>new</code> 开始让 <code>V8 引擎</code>发挥作用</p> <ul><li>V8 引擎默认创建一个<code>空对象(实例 obj)</code>，并将其 <code>__proto__</code> 指向 <code>构造函数.prototype</code></li> <li>V8 引擎把上下文中的 <code>this</code> 指向该空对象实例（就是把空对象赋值给构造函数内部的 this）</li></ul> <p>做完这些事，再开始执行函数中的代码，返回第一步创建的对象或构造函数的显式返回值</p> <h5 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h5> <ul><li>创建私有变量 <code>y = 100</code> （this 都是创建私有属性）</li> <li>执行 <code>this.x</code> 时，this 已经指向了上面创建的空对象，且创建私有属性 <code>x</code> ，也就是 <code>obj.x = x = 100</code></li> <li>V8 判断没有写 <code>return</code> 或返回的不是一个<code>对象类型</code>的值，就默认把创建的 <code>实例对象</code> 返回</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">200</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
  <span class="token keyword">return</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fn</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">// 根据类 fn 创建实例 res</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// 实例对象 res</span>
</code></pre></div><h4 id="实现-new"><a href="#实现-new" class="header-anchor">#</a> 实现 new</h4> <p>要实现的效果</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 原生的 new</span>
<span class="token keyword">let</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'汪汪'</span><span class="token punctuation">)</span>

<span class="token comment">// 自己实现的 new</span>
<span class="token keyword">let</span> dog <span class="token operator">=</span> <span class="token function">_new</span><span class="token punctuation">(</span>Dog<span class="token punctuation">,</span> <span class="token string">'汪汪'</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="es5-版本"><a href="#es5-版本" class="header-anchor">#</a> ES5 版本</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">Fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 可以用 ...args 拿到剩下的参数</span>
  <span class="token comment">// 1 用 ES5 的方式:借用数组原型上的方法，把类数组转为数组</span>
  <span class="token comment">// 去掉第一个参数，获取剩下的参数数组</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  
  <span class="token comment">// 2 创建空对象，并将原型正确指向</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype
  
  <span class="token comment">// 3 ES6 用法 =&gt; Fn(...args)</span>
  <span class="token comment">// 还是用 ES5 实现：可以把 args 数组一项项传给 Fn</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">Fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
  
  <span class="token comment">// 4 判断是否是引用对象（对象、函数，排除 null），直接返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'Object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 5 返回空对象实例</span>
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><h5 id="es6-版本"><a href="#es6-版本" class="header-anchor">#</a> ES6 版本</h5> <ul><li>用 Object.create 将 obj 的 <code>__proto__</code>指向构造函数的原型</li> <li>使用 apply/call 方法，将构造函数内的 this 指向为 obj</li> <li>在 obj 要先判断是对象或者是函数类型</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">Fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ...args 拿到剩余参数数组</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// 创建空对象，且原型指向 Fn</span>

  <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">Fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token comment">// call 性能较好</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'Object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><h3 id="构造函数属性-constructor"><a href="#构造函数属性-constructor" class="header-anchor">#</a> 构造函数属性 constructor</h3> <p>对象实例拥有的原生属性，指向创建它的构造函数</p> <div class="language-js extra-class"><pre class="language-js"><code>obj1<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Fn <span class="token comment">// true</span>
</code></pre></div><p>但是任然建议使用 <code>instanceof</code>来判断实例是否属于某个构造函数。因为 <code>constructor</code>会被覆盖，不是很准确。</p> <h3 id="私有变量"><a href="#私有变量" class="header-anchor">#</a> 私有变量</h3> <p>在 java 中有 private 等修饰符以保证类中变量是私有的，即外界无法访问</p> <p>在 JS 新特性中有 <code>#</code> 操作符来修饰一个变量来定义成私有的</p> <p>目前大多数去情况下，可能需要自己用技巧去实现私有变量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Book</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1 箭头函数，绑定了 this</span>
  <span class="token comment">// 2 闭包。让自由变量 name 得以保存</span>
  <span class="token comment">// 3 getXXX 方法，外界不能直接访问 name</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">setName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">newName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> newName<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">&quot;Life&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Time&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Time</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 无法访问私有属性 name 的值</span>
</code></pre></div><h3 id="构造函数与原型对象的关系"><a href="#构造函数与原型对象的关系" class="header-anchor">#</a> 构造函数与原型对象的关系</h3> <ul><li>原型对象才是类的唯一标识。实例对象是继承于一个原型对象，而非构造函数。</li> <li>两个不同构造函数的 prototype 属性可能指向同一个原型对象。一般来说构造函数与类同名。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">Array</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 1 构造函数</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype <span class="token comment">// 2 Array 的原型对象（包含了类所需要的方法，也是实例的原型）</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token comment">// 3 指向构造函数，也就是 Aarry 本身（只有函数才有 prototype 属性）</span>

<span class="token comment">// 使用 instanceof 函数，检查的就是该对象的 prototype（原型对象） 属性， 而非其构造函数</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
arr <span class="token keyword">instanceof</span> <span class="token class-name">Array</span>  <span class="token comment">// 4 判断 arr 的构造函数 Array ，是否在 arr 原型链上的任意位置</span>
</code></pre></div><h3 id="方法为什么要写在原型上"><a href="#方法为什么要写在原型上" class="header-anchor">#</a> 方法为什么要写在原型上</h3> <ul><li>写在构造函数中，会让每个实例对象都拥有。会资源浪费。</li> <li>写在原型对象中，实例对象不需要拥有，可以通过原型链回溯找到并直接使用</li> <li>修改原型链，在修改之前就被实例化的对象也能使用新增或修改的方法或属性</li></ul> <h2 id="原型和原型对象"><a href="#原型和原型对象" class="header-anchor">#</a> 原型和原型对象</h2> <h3 id="基本属性和-api"><a href="#基本属性和-api" class="header-anchor">#</a> 基本属性和 API</h3> <ul><li><p>原型：原型对象的引用地址</p></li> <li><p>原型对象：放了很多共享属性和方法的对象</p></li> <li><p>对象的原型： <code>obj.__proto__</code></p> <ul><li>与下面的 <code>prototype</code>指向的是同一个地方</li> <li>注意是左右各2个下划线</li></ul></li> <li><p>虽然这个 <code>__proto__</code>被所有浏览器兼容，但是不是纳入标准的。因为有性能上的问题。所以推荐使用新的 API 来读写分离</p> <ul><li><p><code>Object.getPrototypeOf()</code> 来代替该属性的读取功能，作用就是获取对象的原型</p></li> <li><p><code>Object.setPrototypeOf()</code> 设置对象的原型</p></li> <li><p><code>Object.create</code>，创建指定原型的新对象，原型可以是 <code>null</code></p></li></ul></li> <li><p>构造函数的原型： <code>fn.prototype</code></p> <ul><li>该属性，可读写，不可枚举</li></ul></li> <li><p>通过原型找构造函数</p> <ul><li><code>Fn.prototype.constructor === Fn</code> （constructor 属性是在 prototype 这个对象上的）</li> <li><code>[].constructor === Array</code> （实际上是先通过 <code>__proto__</code> 在通过上面的 <code>constructor</code>属性）</li></ul></li> <li><p><code>a instanceof A</code>：判断左边的对象是否是右边构造函数创建的，即测试一个对象在其原型链中是否存在一个构造函数的 <code>prototype</code> 属性</p></li> <li><p><code>A.isPrototypeOf(B)</code> , A 对象是否存在于 B 对象的原型链上</p></li> <li><p><code>obj.hasOwnProperty('fn')</code>：判断属性或者方法 fn 是否属于obj这个实例。是的话true， 不是的话false。一般用来判断这个属性或方法到底在实例中定义 (true) 的还是在原型对象中定义 (false) 的。</p></li></ul> <h3 id="instanceof-鉴别对象原型"><a href="#instanceof-鉴别对象原型" class="header-anchor">#</a> instanceof  鉴别对象原型</h3> <p>实现一下原理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token keyword">instanceof</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prototype <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype <span class="token comment">// 1 获得构造函数的原型</span>
  left <span class="token operator">=</span> left<span class="token punctuation">.</span>_proto_ <span class="token comment">// 2 获得对象的原型</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 3 判断对象的类型是否等于构造函数的原型</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> left <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token comment">// 该对象没有原型对象。直接结束。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> prototypr <span class="token operator">===</span> left <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// 原型对象一致</span>
    left <span class="token operator">=</span> left<span class="token punctuation">.</span>_proto_
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="hasprototypeproperty-鉴别原型属性"><a href="#hasprototypeproperty-鉴别原型属性" class="header-anchor">#</a> hasPrototypeProperty 鉴别原型属性</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">hasPrototypeProperty</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// in 操作符判断是自有属性和原型属性</span>
  <span class="token comment">// 同时满足该属性不是自有属性</span>
  <span class="token comment">// 那么就相当于是判断该属性是否是原型属性</span>
  <span class="token keyword">return</span> name <span class="token keyword">in</span> object <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>object<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="prototype-属性"><a href="#prototype-属性" class="header-anchor">#</a> [[Prototype]] 属性</h3> <p>用内部属性 <code>[[Prototype]]</code>跟踪对象实例的原型对象。</p> <p>当用new创建一个对象，构造函数的原型对象就会赋值给该对象的 <code>[[Prototype]]</code>属性</p> <ul><li>用 <code>Object.getPrototypeOf</code>读取 [[Prototype]]属性的值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

<span class="token comment">// obj 是泛用对象，所以都是指向 Object</span>
prototype <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype
</code></pre></div><ul><li>大多数浏览器 JS 引擎给所有对象上增加了 <code>_proto_</code>的属性，可以直接读写 <code>[[Prototype]]</code>的值。但是这个有性能上的问题，所以 ES 标准建议使用2个替代的方法
<ul><li><strong>Object.setPrototypeOf</strong> 改写[[prototype]]属性</li> <li>**Object.getPrototypeOf **读取[[prototype]]属性</li></ul></li></ul> <h3 id="在构造函数中使用原型对象"><a href="#在构造函数中使用原型对象" class="header-anchor">#</a> 在构造函数中使用原型对象</h3> <blockquote><p>原型对象的机制让他们成为一次性为所有对象定义方法的理想手段</p></blockquote> <ul><li>通过原型对象增加变量或方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 给 Fn 构造函数的原型对象增加 getName 方法</span>
<span class="token comment">// 这样所有通过 Fn 创建的实例对象都可以该方法</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
<span class="token punctuation">}</span>
</code></pre></div><ul><li>要特别注意原型对象上的引用类型。因为内存也是共享的</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Fn<span class="token punctuation">.</span>protytype<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment">// 创建2个实例</span>
<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 操作原型对象上的数组变量 arr</span>
obj1<span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
obj2<span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
obj2<span class="token punctuation">.</span>arr <span class="token comment">// [1,2]，原型对象上的数组被修改2次，因为是引用类型</span>
</code></pre></div><ul><li>字面量形式替换原型对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 字面量形式改变了原型对象属性，因为现在指向 Object 而不是 Fn。所以要重置该属性</span>
  <span class="token comment">// 且注意要放在第一行，避免在没有正确指向的时候调用了方法。</span>
  constructor<span class="token operator">:</span>Fn<span class="token punctuation">,</span> 
  <span class="token function-variable function">sayName</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">toString</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="改变原型对象"><a href="#改变原型对象" class="header-anchor">#</a> 改变原型对象</h3> <p>简单来说就是后来增删的原型对象上的变量或属性，都会立即反应到所有实例上。</p> <p>因为这个原型对象就是一个指向它的指针引用</p> <h3 id="内建对象的原型对象"><a href="#内建对象的原型对象" class="header-anchor">#</a> 内建对象的原型对象</h3> <p>就是可以修改一些内建对象的原型对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 可以自己重写以赋予更多能力</span>
  <span class="token comment">// 实际开发不建议这样做，这会让新人无法确定该方法的作用</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="js-和-java-的区别"><a href="#js-和-java-的区别" class="header-anchor">#</a> JS 和 JAVA 的区别</h3> <p>JAVA 创建的实例对象，会把类中的特性继承下来</p> <p>JS 创建的实例不会默认继承他们，而是通过原型链去找（这就是 JS 轻量的原因）</p> <h2 id="原型链机制"><a href="#原型链机制" class="header-anchor">#</a> 原型链机制</h2> <blockquote><p>原型链，解决对象创建时的内存开销。通过链式查找共享属性和方法</p></blockquote> <p>每个对象都有原型对象，当然通过 <code>Object.create(null)</code>  是没有原型对象的</p> <p>当我们需要使用对象的某个方法时 <code>obj.fn</code>，它的回溯查找顺序</p> <ul><li>对象自己身上的方法</li> <li>原型对象上的方法</li> <li><code>Object.prototype</code> 上的方法
<ul><li><code>Object.prototype</code>  是所有对象的祖宗原型</li> <li>Object 也有很多内置方法，如之前看到的 <code>toString</code> 和 <code>hasOwnProperty</code></li> <li>创建的每个对象，默认的原型是Object对象。我们可以改变这些对象的原型指向，但重点都是Object</li></ul></li> <li>null —— 返回 Undefined</li></ul> <h3 id="类和实例对象"><a href="#类和实例对象" class="header-anchor">#</a> 类和实例对象</h3> <p>在 JS 中的类，本质上都是 <code>函数</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code>Array 是一个数组类
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span> 这些都是数组的实例对象
</code></pre></div><h3 id="原型对象"><a href="#原型对象" class="header-anchor">#</a> 原型对象</h3> <ul><li>对于类来说</li></ul> <p>有一个保存自己基因的地方，这就是 <code>原型对象</code>，也就是每个类（函数）的 <code>prototype</code> 属性。</p> <ul><li>对于实例对象来说</li></ul> <p>除了自己的私有属性、方法，还能根据 <code>__proto__</code> 属性找到所属类的原型对象 <code>prototype</code></p> <h3 id="原型链机制-2"><a href="#原型链机制-2" class="header-anchor">#</a> 原型链机制</h3> <p>比如要找 <code>[1,2,3].push()</code> 中的 push 方法，其过程如下</p> <ul><li>先找 <code>[1,2,3]</code> 这个实例对象的私有方法</li> <li>再通过 <code>__proto__</code> 找到所属类的原型对象上的方法</li> <li>还是找不到，就一直顺着这个链子上去，直到 <code>Object.prototype</code> 为止</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 数组对象</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 函数对象</span>

arr <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">null</span> <span class="token comment">// arr 数组对象的原型链</span>
foo <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">null</span> <span class="token comment">// function 函数对象的原型链</span>

<span class="token comment">// 原型对象上有许多方法，是共享的。也就是实例对象本身不需要拥有就可以直接使用的方法，可以理解为 类中的静态方法。</span>
Array<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">Function</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ErrorJe/whole-stack-note/edit/master/docs/p4/javascript/面向对象/05 构造函数和原型.md" target="_blank" rel="noopener noreferrer">编辑文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">1/20/2020, 8:34:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/whole-stack-note/p4/javascript/面向对象/04 对象.html" class="prev">理解对象</a></span> <span class="next"><a href="/whole-stack-note/p4/javascript/面向对象/06 继承方案.html">继承方案</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/whole-stack-note/assets/js/app.a3debe68.js" defer></script><script src="/whole-stack-note/assets/js/2.e13c0dfc.js" defer></script><script src="/whole-stack-note/assets/js/51.37619b9e.js" defer></script><script src="/whole-stack-note/assets/js/4.006c3239.js" defer></script>
  </body>
</html>
