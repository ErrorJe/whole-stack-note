<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue 进阶语法 | FE 前端研究所</title>
    <meta name="description" content="ErrorJE 直辖 Blog | FE 前端研究所">
    <link rel="icon" href="/whole-stack-note/logo.jpg">
  <link rel="manifest" href="/whole-stack-note/manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    
    <link rel="preload" href="/whole-stack-note/assets/css/0.styles.e45b6d8e.css" as="style"><link rel="preload" href="/whole-stack-note/assets/js/app.32c79e15.js" as="script"><link rel="preload" href="/whole-stack-note/assets/js/2.e13c0dfc.js" as="script"><link rel="preload" href="/whole-stack-note/assets/js/74.650ae344.js" as="script"><link rel="preload" href="/whole-stack-note/assets/js/4.006c3239.js" as="script"><link rel="prefetch" href="/whole-stack-note/assets/js/10.5080ced0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/100.acc12b55.js"><link rel="prefetch" href="/whole-stack-note/assets/js/101.703df793.js"><link rel="prefetch" href="/whole-stack-note/assets/js/102.aea63913.js"><link rel="prefetch" href="/whole-stack-note/assets/js/103.52fd9c93.js"><link rel="prefetch" href="/whole-stack-note/assets/js/11.cec1ebb3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/12.af42a027.js"><link rel="prefetch" href="/whole-stack-note/assets/js/13.30948cab.js"><link rel="prefetch" href="/whole-stack-note/assets/js/14.b5861d17.js"><link rel="prefetch" href="/whole-stack-note/assets/js/15.b3fe6a46.js"><link rel="prefetch" href="/whole-stack-note/assets/js/16.b54c7eec.js"><link rel="prefetch" href="/whole-stack-note/assets/js/17.48d93c34.js"><link rel="prefetch" href="/whole-stack-note/assets/js/18.0c526b42.js"><link rel="prefetch" href="/whole-stack-note/assets/js/19.9da136a0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/20.fc0cc2de.js"><link rel="prefetch" href="/whole-stack-note/assets/js/21.323ba669.js"><link rel="prefetch" href="/whole-stack-note/assets/js/22.c781e4b3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/23.76a1b2a0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/24.0bc4974b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/25.f34dad9d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/26.01d63dde.js"><link rel="prefetch" href="/whole-stack-note/assets/js/27.5ed8ffac.js"><link rel="prefetch" href="/whole-stack-note/assets/js/28.79087a03.js"><link rel="prefetch" href="/whole-stack-note/assets/js/29.d0ee654e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/3.7611bd43.js"><link rel="prefetch" href="/whole-stack-note/assets/js/30.d2bfcc51.js"><link rel="prefetch" href="/whole-stack-note/assets/js/31.3dacf949.js"><link rel="prefetch" href="/whole-stack-note/assets/js/32.6bd49ece.js"><link rel="prefetch" href="/whole-stack-note/assets/js/33.dec9ad8a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/34.7bad766d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/35.e0cd51ea.js"><link rel="prefetch" href="/whole-stack-note/assets/js/36.43d6fb08.js"><link rel="prefetch" href="/whole-stack-note/assets/js/37.acc7b80e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/38.272e2e72.js"><link rel="prefetch" href="/whole-stack-note/assets/js/39.ddfe027f.js"><link rel="prefetch" href="/whole-stack-note/assets/js/40.3a01b9ab.js"><link rel="prefetch" href="/whole-stack-note/assets/js/41.320c56ec.js"><link rel="prefetch" href="/whole-stack-note/assets/js/42.bccd4f9b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/43.89354e9c.js"><link rel="prefetch" href="/whole-stack-note/assets/js/44.aea411c3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/45.2eeb97df.js"><link rel="prefetch" href="/whole-stack-note/assets/js/46.1f0c5056.js"><link rel="prefetch" href="/whole-stack-note/assets/js/47.36314954.js"><link rel="prefetch" href="/whole-stack-note/assets/js/48.fea3089b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/49.9e1bf2f1.js"><link rel="prefetch" href="/whole-stack-note/assets/js/5.353e6219.js"><link rel="prefetch" href="/whole-stack-note/assets/js/50.d959c541.js"><link rel="prefetch" href="/whole-stack-note/assets/js/51.37619b9e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/52.c6eeddd2.js"><link rel="prefetch" href="/whole-stack-note/assets/js/53.777f1a99.js"><link rel="prefetch" href="/whole-stack-note/assets/js/54.3a928b8b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/55.da530c09.js"><link rel="prefetch" href="/whole-stack-note/assets/js/56.1dfb41b8.js"><link rel="prefetch" href="/whole-stack-note/assets/js/57.eae4eae8.js"><link rel="prefetch" href="/whole-stack-note/assets/js/58.a0758c48.js"><link rel="prefetch" href="/whole-stack-note/assets/js/59.5ce91a2d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/6.c96f94a6.js"><link rel="prefetch" href="/whole-stack-note/assets/js/60.7b906567.js"><link rel="prefetch" href="/whole-stack-note/assets/js/61.4d627f04.js"><link rel="prefetch" href="/whole-stack-note/assets/js/62.72627354.js"><link rel="prefetch" href="/whole-stack-note/assets/js/63.5dac86c7.js"><link rel="prefetch" href="/whole-stack-note/assets/js/64.4daccaa3.js"><link rel="prefetch" href="/whole-stack-note/assets/js/65.95f93d6f.js"><link rel="prefetch" href="/whole-stack-note/assets/js/66.41628c42.js"><link rel="prefetch" href="/whole-stack-note/assets/js/67.fa91107d.js"><link rel="prefetch" href="/whole-stack-note/assets/js/68.a0bfb54b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/69.44695771.js"><link rel="prefetch" href="/whole-stack-note/assets/js/7.c6dd592b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/70.883e83a8.js"><link rel="prefetch" href="/whole-stack-note/assets/js/71.04c8b4ca.js"><link rel="prefetch" href="/whole-stack-note/assets/js/72.73ff2746.js"><link rel="prefetch" href="/whole-stack-note/assets/js/73.e54ae128.js"><link rel="prefetch" href="/whole-stack-note/assets/js/75.03556209.js"><link rel="prefetch" href="/whole-stack-note/assets/js/76.92302603.js"><link rel="prefetch" href="/whole-stack-note/assets/js/77.06ffc25a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/78.2433a431.js"><link rel="prefetch" href="/whole-stack-note/assets/js/79.3506d106.js"><link rel="prefetch" href="/whole-stack-note/assets/js/8.18958710.js"><link rel="prefetch" href="/whole-stack-note/assets/js/80.b01ec45a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/81.58c7dc94.js"><link rel="prefetch" href="/whole-stack-note/assets/js/82.27922683.js"><link rel="prefetch" href="/whole-stack-note/assets/js/83.6d434690.js"><link rel="prefetch" href="/whole-stack-note/assets/js/84.164af512.js"><link rel="prefetch" href="/whole-stack-note/assets/js/85.c0a4b83c.js"><link rel="prefetch" href="/whole-stack-note/assets/js/86.c1a820c9.js"><link rel="prefetch" href="/whole-stack-note/assets/js/87.06bfdf33.js"><link rel="prefetch" href="/whole-stack-note/assets/js/88.a88abf23.js"><link rel="prefetch" href="/whole-stack-note/assets/js/89.2f15869a.js"><link rel="prefetch" href="/whole-stack-note/assets/js/9.dafc73ec.js"><link rel="prefetch" href="/whole-stack-note/assets/js/90.9e02f225.js"><link rel="prefetch" href="/whole-stack-note/assets/js/91.92f33ca4.js"><link rel="prefetch" href="/whole-stack-note/assets/js/92.72b24c0e.js"><link rel="prefetch" href="/whole-stack-note/assets/js/93.65956fda.js"><link rel="prefetch" href="/whole-stack-note/assets/js/94.cd96b01b.js"><link rel="prefetch" href="/whole-stack-note/assets/js/95.f9417ba0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/96.74b47339.js"><link rel="prefetch" href="/whole-stack-note/assets/js/97.0a771bb2.js"><link rel="prefetch" href="/whole-stack-note/assets/js/98.77ae86f0.js"><link rel="prefetch" href="/whole-stack-note/assets/js/99.09bcc662.js">
    <link rel="stylesheet" href="/whole-stack-note/assets/css/0.styles.e45b6d8e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/whole-stack-note/" class="home-link router-link-active"><!----> <span class="site-name">FE 前端研究所</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/whole-stack-note/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端初级" class="dropdown-title"><span class="title">前端初级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>HTML / CSS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-base/" class="nav-link">HTML 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-pro/" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-base/" class="nav-link">CSS 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-pro/" class="nav-link">CSS3 / CSS4</a></li></ul></li><li class="dropdown-item"><h4>JS 基础与进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/es-next/01 let 变量和 const 常量.html" class="nav-link">ES-Next</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/typescript/00 基础知识.html" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/jquery/" class="nav-link">JQuery</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/browser/DOM.html" class="nav-link">浏览器原理</a></li></ul></li><li class="dropdown-item"><h4>项目包管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/npm/" class="nav-link">NPM</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/yarn/" class="nav-link">YARN</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/learn/" class="nav-link">LEARN</a></li></ul></li><li class="dropdown-item"><h4>团队协作</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/code-format/" class="nav-link">代码规范</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/tools/" class="nav-link">开发工具链</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端中级" class="dropdown-title"><span class="title">前端中级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>移动端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/h5/" class="nav-link">H5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/uni-app/" class="nav-link">Uni-App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/react-native/" class="nav-link">React Native</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/fullter/" class="nav-link">Fullter</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/wechat/" class="nav-link">微信小程序</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/weex/" class="nav-link">Weex</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/mpvue/" class="nav-link">MpVue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/pwa/" class="nav-link">PWA</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/native-app/" class="nav-link">Native App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/hybird-app/" class="nav-link">Hybird App</a></li></ul></li><li class="dropdown-item"><h4>开发框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-base/" class="nav-link router-link-active">Vue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-element-admin/" class="nav-link">Vue-Element-Admin</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/react-base/" class="nav-link">React</a></li></ul></li><li class="dropdown-item"><h4>NodeJS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/node-base/" class="nav-link">Node 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/express.html" class="nav-link">Express</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/koa.html" class="nav-link">Koa</a></li></ul></li><li class="dropdown-item"><h4>面试相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/business/" class="nav-link">业务开发</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/topic/" class="nav-link">面试题</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/live/" class="nav-link">记录</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/economics/" class="nav-link">经济学</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/growth/" class="nav-link">程序员成长</a></li></ul></div></div><div class="nav-item"><a href="/whole-stack-note/my-resume.html" class="nav-link">Resume</a></div> <a href="https://github.com/ErrorJe/whole-stack-note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/whole-stack-note/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端初级" class="dropdown-title"><span class="title">前端初级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>HTML / CSS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-base/" class="nav-link">HTML 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/html-pro/" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-base/" class="nav-link">CSS 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/css-pro/" class="nav-link">CSS3 / CSS4</a></li></ul></li><li class="dropdown-item"><h4>JS 基础与进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/es-next/01 let 变量和 const 常量.html" class="nav-link">ES-Next</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/typescript/00 基础知识.html" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/jquery/" class="nav-link">JQuery</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/browser/DOM.html" class="nav-link">浏览器原理</a></li></ul></li><li class="dropdown-item"><h4>项目包管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/npm/" class="nav-link">NPM</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/yarn/" class="nav-link">YARN</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/package/learn/" class="nav-link">LEARN</a></li></ul></li><li class="dropdown-item"><h4>团队协作</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/code-format/" class="nav-link">代码规范</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p4/team/tools/" class="nav-link">开发工具链</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端中级" class="dropdown-title"><span class="title">前端中级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>移动端开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/h5/" class="nav-link">H5</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/uni-app/" class="nav-link">Uni-App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/react-native/" class="nav-link">React Native</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/fullter/" class="nav-link">Fullter</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/wechat/" class="nav-link">微信小程序</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/weex/" class="nav-link">Weex</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/mpvue/" class="nav-link">MpVue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/pwa/" class="nav-link">PWA</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/native-app/" class="nav-link">Native App</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/web-app/hybird-app/" class="nav-link">Hybird App</a></li></ul></li><li class="dropdown-item"><h4>开发框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-base/" class="nav-link router-link-active">Vue</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/vue-element-admin/" class="nav-link">Vue-Element-Admin</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/react-base/" class="nav-link">React</a></li></ul></li><li class="dropdown-item"><h4>NodeJS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/node-base/" class="nav-link">Node 基础</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/express.html" class="nav-link">Express</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/node-js/koa.html" class="nav-link">Koa</a></li></ul></li><li class="dropdown-item"><h4>面试相关</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/business/" class="nav-link">业务开发</a></li><li class="dropdown-subitem"><a href="/whole-stack-note/p5/interview/topic/" class="nav-link">面试题</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/live/" class="nav-link">记录</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/economics/" class="nav-link">经济学</a></li><li class="dropdown-item"><!----> <a href="/whole-stack-note/blog/growth/" class="nav-link">程序员成长</a></li></ul></div></div><div class="nav-item"><a href="/whole-stack-note/my-resume.html" class="nav-link">Resume</a></div> <a href="https://github.com/ErrorJe/whole-stack-note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/whole-stack-note/p5/vue-base/" class="sidebar-link">Vue</a></li><li><a href="/whole-stack-note/p5/vue-base/01 Vue 基础.html" class="sidebar-link">Vue 基础（版本、生命周期与环境）</a></li><li><a href="/whole-stack-note/p5/vue-base/02 Vue 项目启动和基本配置.html" class="sidebar-link">Vue 项目启动和基本配置</a></li><li><a href="/whole-stack-note/p5/vue-base/03 Vue 核心语法.html" class="sidebar-link">Vue 核心语法</a></li><li><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html" class="active sidebar-link">Vue 进阶语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#数据响应式" class="sidebar-link">数据响应式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#data-数据劫持" class="sidebar-link">data 数据劫持</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#proxy-优化" class="sidebar-link">Proxy 优化</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#数据来源" class="sidebar-link">数据来源</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#computed-watch-methods-区别" class="sidebar-link">computed | watch | methods 区别</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#computed-计算属性" class="sidebar-link">computed 计算属性</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#watch-监听器" class="sidebar-link">watch 监听器</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#vm-nexttick（cb）" class="sidebar-link">vm.$nextTick（cb）</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#vue-observable" class="sidebar-link">Vue.observable</a></li></ul></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#插槽（slot）" class="sidebar-link">插槽（slot）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#slot-基本用法" class="sidebar-link">slot 基本用法</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#插槽也是父子组件的概念" class="sidebar-link">插槽也是父子组件的概念</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#后备内容" class="sidebar-link">后备内容</a></li></ul></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#自定义指令" class="sidebar-link">自定义指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#生命周期函数" class="sidebar-link">生命周期函数</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#钩子函数的参数" class="sidebar-link">钩子函数的参数</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#指令定义方式" class="sidebar-link">指令定义方式</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#动态指令参数" class="sidebar-link">动态指令参数</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#全局指令的注入" class="sidebar-link">全局指令的注入</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#常见案例实现思路" class="sidebar-link">常见案例实现思路</a></li></ul></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#过滤器filter的使用" class="sidebar-link">过滤器Filter的使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#使用" class="sidebar-link">使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#继承与混合" class="sidebar-link">继承与混合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#vue-mixin" class="sidebar-link">Vue.mixin</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#extends-选项" class="sidebar-link">extends 选项</a></li><li class="sidebar-sub-header"><a href="/whole-stack-note/p5/vue-base/04 Vue 进阶语法.html#合并策略" class="sidebar-link">合并策略</a></li></ul></li></ul></li><li><a href="/whole-stack-note/p5/vue-base/05 Vue 组件基础.html" class="sidebar-link">Vue 组件基础</a></li><li><a href="/whole-stack-note/p5/vue-base/06 Vue 父子组件通信.html" class="sidebar-link">Vue 父子组件通信</a></li><li><a href="/whole-stack-note/p5/vue-base/07 Vue 跨层级组件通信.html" class="sidebar-link">Vue 跨层级组件通信</a></li><li><a href="/whole-stack-note/p5/vue-base/08 Vue 函数式组件和 JSX 应用.html" class="sidebar-link">Vue 函数式组件和 JSX 应用</a></li><li><a href="/whole-stack-note/p5/vue-base/09 Vue 过渡和动画.html" class="sidebar-link">Vue 过渡和动画</a></li><li><a href="/whole-stack-note/p5/vue-base/10 Vue-Cli 脚手架.html" class="sidebar-link">vue-cli 脚手架</a></li><li><a href="/whole-stack-note/p5/vue-base/11 Vue-Router 路由器.html" class="sidebar-link">Vue-Router 路由器</a></li><li><a href="/whole-stack-note/p5/vue-base/12 Vuex 状态管理器.html" class="sidebar-link">Vuex 状态管理器</a></li><li><a href="/whole-stack-note/p5/vue-base/13 Vant 项目.html" class="sidebar-link">Vant 项目</a></li><li><a href="/whole-stack-note/p5/vue-base/14 v-tooltip 中文文档翻译.html" class="sidebar-link">v-tooltip 中文文档翻译</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-进阶语法"><a href="#vue-进阶语法" class="header-anchor">#</a> Vue 进阶语法</h1> <h2 id="数据响应式"><a href="#数据响应式" class="header-anchor">#</a> 数据响应式</h2> <h3 id="data-数据劫持"><a href="#data-数据劫持" class="header-anchor">#</a> data 数据劫持</h3> <blockquote><p>只有定义在 data 中的数据才能响应，vue 把响应式系统的数据放在了 <code>data 选项中</code></p></blockquote> <h4 id="响应式原理"><a href="#响应式原理" class="header-anchor">#</a> 响应式原理</h4> <p>vue 是通过数据劫持，达到数据绑定。也就是在 data 第一次初始化注入的时候就决定了数据的绑定；</p> <ul><li>Vue 底层将遍历 <code>data</code>选项中所有的属性，并在实例初始化时用 <code>Object.defineProperty</code> （ES5 中无法被 shim 的属性[就是在低级环境下无法实现的属性功能]，所以不支持 IE8 及更低的浏览器）把属性全转为 <code>getter/setter</code></li> <li>同时，被劫持的 data（setter/getter） ，也必须在 template 模板中被使用才会被依赖收集后监听（由 watcher 去监听，把接触过的数据属性记录为依赖）。这些记录可以通过 <code>vue-devtools</code> 来查看追踪</li> <li>最后的视图其实是当 <code>setter</code> 被触发，再由 <code>watcher</code>（每个组件实例都有一个自己的 渲染watcher）去通知更新的。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">'xxxxx'</span><span class="token punctuation">,</span> <span class="token comment">// 这种是简单的，能够响应</span>
      <span class="token comment">// 这种结构的，之后如果往里面增加新的 k/v ，vue不能处理和响应</span>
      foo<span class="token operator">:</span> <span class="token punctuation">{</span>
        bar<span class="token operator">:</span> <span class="token string">'baer'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">.</span>abc<span class="token operator">=</span><span class="token string">'aa'</span><span class="token comment">// 这种方式是不会响应的(abc 属性没有被定义)</span>
    <span class="token comment">// 1 这样才能响应，动态增加属性</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$<span class="token keyword">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token string">'aa'</span><span class="token punctuation">)</span>
    <span class="token comment">// 2 也可以调用全局方法</span>
    Vue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token string">'aa'</span><span class="token punctuation">)</span> 
    <span class="token comment">// 3 创建新对象覆盖原响应对象</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>foo <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">,</span> <span class="token punctuation">{</span>abc<span class="token operator">:</span><span class="token string">'aa'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="全局和组件-data-选项的区别"><a href="#全局和组件-data-选项的区别" class="header-anchor">#</a> 全局和组件 data 选项的区别</h4> <p>另外，使用 HTML 引入 vue 库中使用 data 的方式，和直接在 .vue 单文件中使用是不一样的</p> <ul><li>前者，使用 object 的方式。这样会在全局都进行注册</li> <li>后者，由于是组件间互不影响，所以是用 function 的形式。也是组件中唯一的使用方式。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1 HTML 中使用 data</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span>
    msg<span class="token operator">:</span><span class="token string">'Object对象'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 2 vue 中使用 data</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token operator">:</span><span class="token string">'Function方法'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="不被感知的修改方式及其解决方案"><a href="#不被感知的修改方式及其解决方案" class="header-anchor">#</a> 不被感知的修改方式及其解决方案</h4> <p>以下这些问题是 vue2.x 版本的问题，在 Vue3 中使用 <code>proxy</code> 解决了这些问题</p> <h5 id="数组中不被感知的2种情况"><a href="#数组中不被感知的2种情况" class="header-anchor">#</a> 数组中不被感知的2种情况</h5> <ul><li><code>arr[index] = newItem</code>， 通过索引设置
<ul><li>解决1：<code>Vue.set(arr, index, newValue)</code> 或者 <code>this.$set(arr. index, value)</code>手动增加某个索引下值的响应
<ul><li>内部也是调用了被重写的 <code>splice</code> 方法</li></ul></li> <li>解决2：通过<code>splice</code>解决。<code>arr.splice(indexItem, 1, newValue)</code>。
<ul><li>因为数组是引用对象，splice 方法是直接修改原引用对象</li></ul></li></ul></li> <li><code>arr.length = newLength</code>，修改数组长度
<ul><li>解决：利用 <code>splice</code> 方法去改变原数组</li></ul></li> <li>反过来说，要删除的话，不能直接用 <code>delete</code> 关键字。要用 <code>vm.$delete(arr, index)</code></li> <li>另外还有一种情况就是，数组中元素是对象（普通值无法被劫持）， Vue 也会对其进行劫持，所以是有响应的。</li></ul> <h5 id="数组的定义技巧"><a href="#数组的定义技巧" class="header-anchor">#</a> 数组的定义技巧</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 数组中的普通值无法被响应</span>
arr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>

<span class="token comment">// 若数组中的元素是引用类型，则会被响应</span>
arr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>value<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>， <span class="token punctuation">{</span>value<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span>
</code></pre></div><h5 id="对象中不被感知的情况"><a href="#对象中不被感知的情况" class="header-anchor">#</a> 对象中不被感知的情况</h5> <p>vue 不能检测对象属性的增删（因为受到现代 JS 的限制）</p> <ul><li>解决1：手动增加响应式属性， <code>Vue.set(obj, key, value)</code>， <code>this.$set</code>是这个方法的别名
<ul><li>注意，这也仅仅是针对有嵌套情况的数据对象（因为有引用）</li> <li>而不能在实例化后添加根级的响应式属性，所以必须在初始化实例前声明所有的根级响应式属性，就算是空值</li></ul></li> <li>解决2：若要增加多个对象属性，
<ul><li>直接加到原对象上是<strong>不会响应</strong>的， 如<code>this.msg = Object.assign(this.message, {t1:1, t2:2})</code></li> <li>而是要用空对象去组合继承两个对象属性 <code>this.msg = Object.assign({}, this.message, {t1:1, t2:2})</code></li></ul></li></ul> <h3 id="proxy-优化"><a href="#proxy-优化" class="header-anchor">#</a> Proxy 优化</h3> <p>在 Vue 3 中解决了关于数组、对象上述问题。就是浏览器兼容性不好</p> <p>下面展示基本原理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 如何用proxy 来实现响应式原理</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'jw'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    arr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'吃'</span><span class="token punctuation">,</span> <span class="token string">'喝'</span><span class="token punctuation">,</span> <span class="token string">'玩'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 兼容性差  可以代理13种方法 set get</span>
<span class="token comment">// defineProperty他只能对特定的属性 进行拦截</span>
<span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// target 就是原对象 key就是当前取的是哪个值</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// ...console.log('收集依赖');</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 递归代理 只有取到对应值的时候 才会进行代理</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// target[key]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 知道这个机制 先更改索引 在更新长度</span>
    <span class="token keyword">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span> 
      	<span class="token comment">// [1,2,3].length = 4; 数组的 push 操作会先 length改变，再去增删元素</span>
        <span class="token comment">// 判断一下 当前是新增操作还是修改操作</span>
        <span class="token keyword">let</span> oldValue <span class="token operator">=</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3,123]</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>oldValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'新增属性'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>oldValue <span class="token operator">!==</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'修改属性'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// target[key] = value; </span>
      	<span class="token comment">// Reflect.set主要解决设置时 如果设置不成功，设置不成功不会报错，如对象不可配置</span>
        <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 因为是代理对象，所以要用代理后返回的 proxy 对象去操作，而不是直接操作原对象</span>
<span class="token keyword">let</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>handler<span class="token punctuation">)</span>
<span class="token comment">// 懒代理</span>
proxy<span class="token punctuation">.</span>name<span class="token punctuation">.</span>name  <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment">// 1 对象深层属性</span>
proxy<span class="token punctuation">.</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>  <span class="token comment">// 2 数组索引修改值</span>
proxy<span class="token punctuation">.</span>xxx <span class="token operator">=</span>  <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// 3 属性新增</span>
</code></pre></div><h3 id="数据来源"><a href="#数据来源" class="header-anchor">#</a> 数据来源</h3> <p>只有三种方式</p> <ul><li>父组件属性 props</li> <li>自身组件状态 data</li> <li>状态管理器， vuex， Vue.observable</li> <li>计算属性和 watch</li></ul> <h3 id="computed-watch-methods-区别"><a href="#computed-watch-methods-区别" class="header-anchor">#</a> computed | watch | methods 区别</h3> <ul><li>computed 内部不会立马获取值，只有取值的时候才执行。（有缓存，若值没有变化则不更新结果）</li> <li>watch 默认在内部执行一次，因为要算出一个老值，若数据变化则执行回调函数</li> <li>methods 不具备缓存。若在模板中利用 methods 算出结果值，这样对性能不好。因为每次模板更新都要重新执行一次</li></ul> <h3 id="computed-计算属性"><a href="#computed-计算属性" class="header-anchor">#</a> computed 计算属性</h3> <blockquote><p>监听的数据必须是在响应式数据中的，普通变量无法监听。
且是基于依赖的响应式数据进行缓存，只有相关依赖发生变化才会重新求值</p></blockquote> <ul><li>一般来说，<code>set</code> 方法不太使用，主要是配合 <code>v-model</code> 完成一些特定的需求</li> <li>另外 set 不要改自己，会死循环。出现要改自己的情况，要利用第三个变量来存储操作结果</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token number">1</span>name<span class="token operator">:</span><span class="token string">'xxx'</span><span class="token punctuation">,</span>
      <span class="token number">2</span>name<span class="token operator">:</span><span class="token string">'yyy'</span><span class="token punctuation">,</span>
      newName<span class="token operator">:</span><span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// 使用计算属性，直接可以将多个 data 属性一起处理</span>
    <span class="token function-variable function">newName</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">1</span>name <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> <span class="token number">2</span>name
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 其他写法</span>
    newName<span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token number">1</span>name <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> <span class="token number">2</span>name
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> names <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name1 <span class="token operator">=</span> names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name2 <span class="token operator">=</span> names<span class="token punctuation">[</span>names<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="watch-监听器"><a href="#watch-监听器" class="header-anchor">#</a> watch 监听器</h3> <p>可以执行任何逻辑，如异步操作和DOM操作。</p> <ul><li>是一个键值对象。键是要观察的表达式，值是对应回调函数（也可以是方法名或包含选项的对象）
虽然 computed 能做的 watch 都可以做，但是推荐尽量使用 computed。</li> <li>watch 适用于在数据变化时执行异步或开销很大的操作情况。
下面为了笔记方便采用了箭头函数，可能会有问题，注意实际使用</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
      b<span class="token operator">:</span><span class="token punctuation">{</span>c<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      e<span class="token operator">:</span><span class="token punctuation">{</span>f<span class="token operator">:</span><span class="token punctuation">{</span>g<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 复杂对象</span>
      h<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      fn<span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// 1 普通使用</span>
    <span class="token function-variable function">a</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 2 对象属性使用</span>
    <span class="token string">&quot;b.c&quot;</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 3 深层对象使用，只要某个属性值变了就触发</span>
    e<span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token function-variable function">handler</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      deep<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
      immediate<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 运行时立马执行一次。执行时机其实是 created 钩子的时期</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 4 简写</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  
  	<span class="token comment">// 5 绑定方法</span>
  	fn<span class="token operator">:</span> <span class="token string">'handlerFn'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
  	<span class="token function">handlerFn</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span>h <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="子组件获取异步数据"><a href="#子组件获取异步数据" class="header-anchor">#</a> 子组件获取异步数据</h4> <blockquote><p>仍然遵守单项数据流规则。可以监听父组件传来的数据，然后复制到子组件的data变量中。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 子组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;editDataList&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      dataList<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听异步数据，当数据发生改变执行方法</span>
    <span class="token function-variable function">editDataList</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      val<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token string">&quot;isShow&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dataList <span class="token operator">=</span> val
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataList<span class="token punctuation">)</span> <span class="token comment">// 取代 create 拿到异步数据</span>
      <span class="token comment">// 然后把原本在 create 中要做的事放在这里</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="手动增加响应式对象属性"><a href="#手动增加响应式对象属性" class="header-anchor">#</a> 手动增加响应式对象属性</h4> <blockquote><p>若我们要给父组件传给子组件的数据中增加一些字段，这时候要注意。如果这个字段本身没有出现在 <code>props</code>或者 <code>data</code>选项中，那么是不被响应的。
我们的解决方式是手动给它加上该字段的响应。</p></blockquote> <p>就比如说上面 <code>a[&quot;isShow&quot;] = false</code>，这一句代码。<code>isShow</code>字段我们是想用于控制DOM的显隐，如果没有响应，数据是变了，但是视图是不会变的。所以要手动给他加上响应式。</p> <p>这里官方提供了2个API</p> <ul><li><code>Vue.set(vm.someObject, 'b', 2)</code></li> <li><code>this.$set(this.someObject,'b',2)</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 用 watch 监听并加工数据</span>
<span class="token function-variable function">editDataList</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> val
  <span class="token comment">// 手动增加 isShow 的响应式</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$<span class="token keyword">set</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'isShow'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dataList <span class="token operator">=</span> arr<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要看该字段有没有被监听响应，可以打印出来。会有对每个字段的<code>get/set</code>方法。如果没有就说明没有响应。</p> <h3 id="vm-nexttick（cb）"><a href="#vm-nexttick（cb）" class="header-anchor">#</a> vm.$nextTick（cb）</h3> <blockquote><p>异步执行，等DOM渲染完（数据更新后才会触发 DOM 重新渲染）之后才执行callback。</p></blockquote> <p>因为有些事件绑定，如果没有DOM的事先存在，是没有办法绑定上去的。在之前用JS的时候，利用事务委托的性质。因为DOM在加载渲染完之前，很难去预先绑定事件。所以一般都绑定在固定存在的父元素上。而vue中的这个，就可以在DOM加载完之后才执行一些内容。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'已更新'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token comment">// =&gt; '未更新'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token comment">// =&gt; '已更新'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>同时，该 API 返回一个 promise 对象，所以可以用 async/await 去完成相同的事</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'已更新'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token comment">// =&gt; '未更新'</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token comment">// =&gt; '已更新'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最后需要注意：跟 watch 的搭配使用时，他会在 watch 之前执行</p> <h3 id="vue-observable"><a href="#vue-observable" class="header-anchor">#</a> Vue.observable</h3> <ul><li>传入一个需要响应式的对象，然后就会注入到vue实例</li> <li>然后定义修改这个对象值的 mutation 方法</li> <li>写个事件去触发这个 Mutation 方法</li></ul> <p><a data-fancybox="" title="" href="https://raw.githubusercontent.com/ErrorJe/ErrorJE.github.io/images/img/20200114083556.png"><img src="https://raw.githubusercontent.com/ErrorJe/ErrorJE.github.io/images/img/20200114083556.png" alt=""></a></p> <h2 id="插槽（slot）"><a href="#插槽（slot）" class="header-anchor">#</a> 插槽（slot）</h2> <blockquote><p>用于容器类的组件。实际上是一行注释，是一个占位符，用到的时候会被调换成真实的内容DOM。
有具名插槽和匿名插槽，如果内容没有指定插槽，那就会分配到默认插槽空位中</p></blockquote> <h3 id="slot-基本用法"><a href="#slot-基本用法" class="header-anchor">#</a> slot 基本用法</h3> <h4 id="slot-定义"><a href="#slot-定义" class="header-anchor">#</a> slot 定义</h4> <p>创建一个 <code>Win.vue</code> 容器插槽。这里混合里两种插槽（匿名插槽和具名插槽）</p> <ul><li>具名插槽就是 <code>name='xxx'</code></li> <li>默认的可以直接写 <code>slot</code> 标签，可以省略 <code>name='default'</code> 的写法</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>win<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 具名插槽：传入一个数据 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>123<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 匿名插槽 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>food<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>food<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="slot-使用和传值"><a href="#slot-使用和传值" class="header-anchor">#</a> slot 使用和传值</h4> <p>使用时，也要引入注册组件。</p> <blockquote><p><code>v-slot</code> 是 2.6 版本之后具名插槽的 API 用法。</p></blockquote> <ul><li>使用 <code>v-slot</code> 的新写法，就必须是在 <code>template</code> 标签上。这是因为 <code>vue</code> 之前的老写法觉得是在操作 DOM，所以不太好</li> <li>缩写是 <code>#</code>，如 <code>#footer</code></li> <li>还可以传值， <code>v-slot:head=&quot;{a}&quot;</code>，将数据 a 传给具名 <code>head</code> 的插槽
<ul><li>传值了，就是用传入的值解构出来的数据</li> <li>没有传值，<code>{{}}</code>写法用的是当前父组件的数据</li></ul></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>win</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>head</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{a, b, item}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>{{a}}, {{b}}, {{item}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>...其他没有名字的内容分配到默认的插槽中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>default</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>也可以显式地说明这个是默认内容，使用默认插槽坑位<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#footer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>具名插槽 foot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>win</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>之前的老写法，没有限定一定要用 <code>template</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>老版本的作用域插槽</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{a, b, isShow}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="插槽也是父子组件的概念"><a href="#插槽也是父子组件的概念" class="header-anchor">#</a> 插槽也是父子组件的概念</h3> <p>通过自定义属性，同样有参数父传子的用法。</p> <blockquote><p>这里还有一个<code>编译作用域</code>的概念，也就是定义出来的插槽组件和使用这个插槽组件的父级组件之间，作用域是无关的。</p> <p>也就是父级组件在使用这个插槽组件的时候，无法直接使用插槽组件里的变量。</p></blockquote> <h4 id="定义插槽组件（子）"><a href="#定义插槽组件（子）" class="header-anchor">#</a> 定义插槽组件（子）</h4> <p>这里定义一个名为 <code>navigation-link</code> 的插槽组件。绑定了 <code>href</code> 变量，在外面使用的时候，通过自定义属性 <code>url</code> 传入值。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nav-link<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="使用插槽组件（父）"><a href="#使用插槽组件（父）" class="header-anchor">#</a> 使用插槽组件（父）</h4> <p>通过 <code>url</code> 自定义属性传入值。若在上面定义的时候，没有用到 <code>slot</code>坑位，则现在里面的 span 包括 文本都会被忽略渲染。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigation-link</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/profile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fa fa-user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  Your Profile
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigation-link</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="后备内容"><a href="#后备内容" class="header-anchor">#</a> 后备内容</h3> <p>也就是定义插槽组件时， 在 <code>slot</code> 中写的默认值。也只有当父级组件没有给出相应内容时，会渲染这个默认值。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--1 定义组件 &lt;submit-button&gt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span>Submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  
<span class="token comment">&lt;!--2 使用该插槽组件时，没有给出 slot 的内容--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>submit-button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>submit-button</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--3 最后渲染的是默认的内容--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> Submit <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="自定义指令"><a href="#自定义指令" class="header-anchor">#</a> 自定义指令</h2> <ul><li>共享数据，建议用 <code>dataset</code></li> <li>除了<code>el</code>，其他属性都是仅可读的。所以尽量不要去修改</li> <li>当我们需要对 DOM 做底层逻辑处理时，就可能需要用到自定义指令</li></ul> <h3 id="生命周期函数"><a href="#生命周期函数" class="header-anchor">#</a> 生命周期函数</h3> <p>提供给指令的钩子函数</p> <ul><li>bind， 第一次绑定到元素时调用，只调1次。用在绑定一次初始化的内容上</li> <li>inserted，被绑定元素插入父节点时调用（父节点存在就行）</li> <li>update，所有元素节点更新时调用，可能在子节点更新前</li> <li>componentUpdated，所有节点和其子节点更新完成后调用</li> <li>unbind，指令与元素解绑时调用</li></ul> <h3 id="钩子函数的参数"><a href="#钩子函数的参数" class="header-anchor">#</a> 钩子函数的参数</h3> <p>每个钩子（生命周期函数）都有这些参数</p> <ul><li>el， 绑定的元素，可以直接操作 DOM</li> <li>binding，对象
<ul><li>name 不包括 v- 的该自定义指令名</li> <li>expression，绑定值的字符串形式。如 <code>v-tooltip=&quot;xxx&quot;</code>，就是 <code>xxx</code>这个字符串表达式</li> <li>value，指令绑定值，也就是指令后面的表达式值 <code>v-dec:x=&quot;date&quot;</code>， 就是这个 <code>date</code> 表达式的结果值</li> <li>oldValue，指令绑定的前一个值，仅在 update 和 componentUpdated 钩子中用，无论值是否改变都可以</li> <li>arg，传给指令的参数， <code>v-tooltip=&quot;msg&quot;</code>，参数就是变量 msg。如果是动态绑定 <code>v-tooltip:msg=&quot;xxx&quot;</code> 的 msg</li> <li>modfiers,包含修饰符的对象， <code>v-tooltip.foo.bar</code> 就是 {foo:true,bar:true}</li></ul></li> <li>vnode，vue编译生成的虚拟节点
<ul><li>主要是里面的 context 上下文对象，一般是当前组件的 vue 实例</li></ul></li> <li>oldVnode，上一个虚拟节点</li></ul> <h3 id="指令定义方式"><a href="#指令定义方式" class="header-anchor">#</a> 指令定义方式</h3> <h4 id="全局指令"><a href="#全局指令" class="header-anchor">#</a> 全局指令</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'color-swatch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>bakcgroundColor <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="组件指令"><a href="#组件指令" class="header-anchor">#</a> 组件指令</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  directive<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string">'demo'</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// binding.value.color</span>
      <span class="token comment">// binding.value.text</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用的形式就是</p> <div class="language-html extra-class"><pre class="language-html"><code>&lt;span v-demo=&quot;{color:'xxx'}&quot;
</code></pre></div><h3 id="动态指令参数"><a href="#动态指令参数" class="header-anchor">#</a> 动态指令参数</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token operator">&lt;</span>p v<span class="token operator">-</span>pin<span class="token operator">:</span><span class="token punctuation">[</span>direction<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;200&quot;</span><span class="token operator">&gt;</span><span class="token constant">I</span> am pinned onto the page at <span class="token number">200</span>px to the left<span class="token punctuation">.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'pin'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">bind</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'fixed'</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token punctuation">(</span>binding<span class="token punctuation">.</span>arg <span class="token operator">==</span> <span class="token string">'left'</span> <span class="token operator">?</span> <span class="token string">'left'</span> <span class="token operator">:</span> <span class="token string">'top'</span><span class="token punctuation">)</span>
    el<span class="token punctuation">.</span>style<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> binding<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">'px'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#dynamicexample'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      direction<span class="token operator">:</span> <span class="token string">'left'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="全局指令的注入"><a href="#全局指令的注入" class="header-anchor">#</a> 全局指令的注入</h3> <p>单独创建一个文件，引入所有的指令</p> <blockquote><p>全局组件也可以用这种方式</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> eg <span class="token keyword">from</span> <span class="token string">'../directive/eg.js'</span><span class="token punctuation">;</span> <span class="token comment">// </span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">&quot;focus&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token function-variable function">inserted</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            el<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用 Vue.use 的方式注册</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> directives <span class="token keyword">from</span> <span class="token string">&quot;./plugins/directives.js&quot;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>directives<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="常见案例实现思路"><a href="#常见案例实现思路" class="header-anchor">#</a> 常见案例实现思路</h3> <h4 id="日历组件的显隐-v-click-outside"><a href="#日历组件的显隐-v-click-outside" class="header-anchor">#</a> 日历组件的显隐 v-click-outside</h4> <p>主要是有几个点，在业务实现中比较常见。代码不重要，主要的是思路</p> <ul><li>输入框，点击显示其他组件，失焦隐藏其他组件</li> <li>上面显示的组件可能是日历组件
<ul><li>满足点击输入框显示这个日历</li> <li>还要满足就算输入框失焦，但是点击还是在规定范围之内，保持显示</li></ul></li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-click-outside</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hide<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  &lt;input type&quot;text&quot; @focus=&quot;show&quot; /&gt;
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>isShow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    ===显示面板===
    时间
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">// vue 定义</span>
<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    isShow<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 方法</span>
<span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>isShow <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
<span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>isShow <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token comment">// 局部指令</span>
directives<span class="token operator">:</span> <span class="token punctuation">{</span>
  clickOutside： <span class="token punctuation">{</span>
    <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> bindings<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 将事件方法放到 el 上</span>
      el<span class="token punctuation">.</span><span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断被点击对象是否在自己内部</span>
          <span class="token comment">// 自定义指令的表达式值</span>
          <span class="token keyword">let</span> methods <span class="token operator">=</span> bindings<span class="token punctuation">.</span>expression
          <span class="token comment">// vnode.contex 就是当前组件的 vue 实例</span>
          vnode<span class="token punctuation">.</span>context<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      
      <span class="token comment">// 绑定点击事件</span>
      document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> el<span class="token punctuation">.</span>handler<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
      
    <span class="token comment">// 卸载指令</span>
		<span class="token function">unbind</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> el<span class="token punctuation">.</span>handler<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="输入框自动聚焦-v-focus"><a href="#输入框自动聚焦-v-focus" class="header-anchor">#</a> 输入框自动聚焦 v-focus</h4> <p>场景：希望输入框在页面加载后自动聚焦</p> <p>问题：原生可以使用 <code>autofocus</code>，但是 Vue 是先把模板进行编译，此时对于原生 DOM 是已经渲染了。编译完成后才会插入到页面中。所以有时候可以看到页面会闪一下</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-focus</span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">// 指令</span>
directives<span class="token operator">:</span> <span class="token punctuation">{</span>
  focus<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// 方式1： 使用 bind 钩子时，Vue.nextTick</span>
    <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> bindings<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// bind 的执行实际是挂在后，然后 update 后</span>
      <span class="token comment">// vm.nextTick 无法使用，因为此时没有生成 vm 实例，所以只能用全局方法</span>
      Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        el<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
     
    <span class="token comment">// 方式2：选择更加合适的生命周期钩子</span>
    <span class="token function">inserted</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> bingdings<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      el<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="图片懒加载-v-lazyload"><a href="#图片懒加载-v-lazyload" class="header-anchor">#</a> 图片懒加载 v-lazyload</h4> <h5 id="基本用法"><a href="#基本用法" class="header-anchor">#</a> 基本用法</h5> <p>这原本是一个 github 上 vue 的插件，就是 <code>npm i vue-lazyload</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入插件</span>
<span class="token keyword">import</span> VuelazyLoad <span class="token keyword">from</span> <span class="token string">'vue-lazyload'</span>
<span class="token comment">// 引入图片</span>
<span class="token keyword">import</span> loading <span class="token keyword">from</span> <span class="token string">'./liading.png'</span>

<span class="token comment">// 注册插件</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VuelazyLoad<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  preLoad<span class="token operator">:</span> <span class="token number">1.3</span><span class="token punctuation">,</span> <span class="token comment">// 当前DOM可见区域的 1.3 倍</span>
  loading<span class="token punctuation">,</span> <span class="token comment">// loading 的加载图</span>
  error<span class="token operator">:</span> 错误的图片url
<span class="token punctuation">}</span><span class="token punctuation">)</span> 

<span class="token comment">// 基本用法</span>
<span class="token operator">&lt;</span>img v<span class="token operator">-</span>lazy<span class="token operator">=</span><span class="token string">'img'</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h5 id="源码实现"><a href="#源码实现" class="header-anchor">#</a> 源码实现</h5> <p>自己去实现一下，既然网上有现成的实际项目就用那个插件库就好了。</p> <p><code>vue-lazyload</code> 主要就是提供一个指令，应用场景主要有三块</p> <ul><li>注册一些全局组件</li> <li>给 vue 原型扩展属性</li> <li>赋予一些全局指令和过滤器</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue-lazyload/index.js</span>
<span class="token comment">// 实现 v-lozyLoad</span>
<span class="token comment">// 通常作为插件，我们还会 let _Vue 来保存引入的 vue 构造函数</span>

<span class="token keyword">import</span> Lazy <span class="token keyword">from</span> <span class="token string">'./lazy'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// vue.use 会默认调用插件的 install 方法</span>
  <span class="token comment">// 参数1：vue 构造函数。为了避免手动引入而导致只能使用某个版本，所以索性 Vue 直接提供给我们的插件</span>
  <span class="token comment">// 参数2：用户要传入的插件参数对象</span>
  <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> LazyClass <span class="token operator">=</span> <span class="token function">Lazy</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span>
    <span class="token keyword">const</span> lazy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LazyClass</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
    
    <span class="token comment">// 全局指令</span>
    <span class="token comment">// 把各个指令钩子都作为方法抽离到 lazy.js 中</span>
    Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'lazy'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// 保证当前 add 方法执行时，this 永远指向 lazy 实例</span>
      bind<span class="token operator">:</span> lazy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>lazy<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>分离代码</p> <ul><li>面向对象思想、实例状态管理</li> <li>利用<code>getBoundingClientRect</code> 获取元素高度判断是否在可视区域</li> <li>防抖（最后只触发一次）节流（每隔固定时间触发一次）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue-lazyload/lazy.js</span>

<span class="token comment">// 节流 | 防抖方法</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>throttle<span class="token punctuation">,</span> debounce<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lodash'</span>

<span class="token comment">// 存放懒加载功能的文件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断当前图片是否在可见区域内的图片类</span>
  <span class="token keyword">class</span> <span class="token class-name">ReactiveListener</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>el<span class="token punctuation">,</span> src<span class="token punctuation">,</span> elRenderer<span class="token punctuation">,</span> options<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> el
      <span class="token keyword">this</span><span class="token punctuation">.</span>src <span class="token operator">=</span> src
      <span class="token keyword">this</span><span class="token punctuation">.</span>elRenderer <span class="token operator">=</span> elRenderer
      <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options
      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token comment">// 默认是没有加载的状态</span>
    <span class="token punctuation">}</span> 		

    <span class="token comment">// 判断是否渲染</span>
    <span class="token function">checkInView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
      <span class="token keyword">let</span> <span class="token punctuation">{</span>top<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 高度就是图片的位置</span>
      <span class="token keyword">return</span> top <span class="token operator">&lt;</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>preLoad <span class="token comment">// 浏览器高度*扩展值</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 加载当前的listener</span>
    <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
      <span class="token comment">// 开始渲染 渲染前 需要默认渲染loading状态</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">elRenderer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">'loading'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 异步加载图片</span>
      <span class="token function">loadImageAsync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>src<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> 
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 加载完毕了</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">elRenderer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">'loaded'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">// 加载失败</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">elRenderer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
	
  <span class="token comment">// 异步加载图片</span>
  <span class="token keyword">function</span> <span class="token function">loadImageAsync</span><span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span>resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    image<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
    image<span class="token punctuation">.</span>onload <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
    image<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">LazyClass</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options <span class="token comment">// 保存用户传入的数据</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>listenerQueue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 图片实例</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>bindHandler <span class="token operator">=</span> <span class="token boolean">false</span>

      <span class="token comment">// 图片状态和可视区域判断方法（最核心方法）</span>
      lazyLoadHandler<span class="token operator">:</span><span class="token function">throttle</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 节流</span>
        <span class="token keyword">let</span> catIn <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>listenerQueue<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">listener</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>listener<span class="token punctuation">.</span>state<span class="token punctuation">.</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span> <span class="token comment">// 如果已经渲染过的图片就不在进行渲染了</span>
          catIn <span class="token operator">=</span> listener<span class="token punctuation">.</span><span class="token function">checkInView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 判断是否应该渲染</span>
          catIn <span class="token operator">&amp;&amp;</span> listener<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 加载对应的 listener</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token comment">// 一般是 200-300 用户无感知</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 就是指令的 bind 钩子要执行的方法</span>
    <span class="token comment">// 经过绑定， this 一直指向 lazy 实例</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> bingdings<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 监控父亲 DOM 的滚动事件，滚动时检查当前图片是否在 可视区域内</span>

      <span class="token comment">// 因为 el 此时获取的不是真实 DOM，所以要用 NextTick</span>
      Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 找到有滚动事件的爸爸 DOM 容器</span>
        <span class="token keyword">function</span> <span class="token function">scrollParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> parent <span class="token operator">=</span> el<span class="token punctuation">.</span>parentNode
          <span class="token keyword">while</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/scroll/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'overflow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> parent
            <span class="token punctuation">}</span>
            parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parentNode <span class="token comment">// 不停向上找带 overflow 属性的容器</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> parent
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> parent <span class="token operator">=</span> <span class="token function">scrollParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// 判断当前图片需要加载</span>
        <span class="token keyword">let</span> listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReactiveListener</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          el<span class="token punctuation">,</span> <span class="token comment">// 真实的 dom</span>
          src<span class="token operator">:</span> bingings<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token comment">// 对应 v-lazy 的值</span>
          <span class="token comment">// 图片可渲染时调用的方法</span>
          <span class="token comment">// 因为该方法可以给别人用，所以可能有 this 的影响，因而要做一次 this 绑定</span>
          elRenderer<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">elRenderer</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
          options<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>listenerQueue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>bindHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 该 DOM 已经绑定过事件</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>bindHandler <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token comment">// 绑定滚动时判断图片加载事件</span>
          parent<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lazyLoadHandler<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 默认也需要一次判断</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">lazyLoadHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 渲染当前实例的状态图</span>
    <span class="token function">elRenderer</span><span class="token punctuation">(</span><span class="token parameter">listener<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span>el<span class="token punctuation">}</span> <span class="token operator">=</span> listener
      <span class="token keyword">let</span> src <span class="token operator">=</span><span class="token string">' '</span>

      <span class="token comment">// 当前什么状态就渲染什么</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'laoding'</span><span class="token operator">:</span>
          src <span class="token operator">=</span> listener<span class="token punctuation">.</span>options<span class="token punctuation">.</span>loading <span class="token operator">||</span> <span class="token string">''</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'error'</span><span class="token operator">:</span>
          src <span class="token operator">=</span> listener<span class="token punctuation">.</span>options<span class="token punctuation">.</span>errpr <span class="token operator">||</span> <span class="token string">''</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
          src <span class="token operator">=</span> listener<span class="token punctuation">.</span>src
          <span class="token keyword">break</span> 
      <span class="token punctuation">}</span>

      <span class="token comment">// 绑定属性值</span>
      el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="过滤器filter的使用"><a href="#过滤器filter的使用" class="header-anchor">#</a> 过滤器Filter的使用</h2> <blockquote><p>全局的话还是在main**.**js中写：过滤器一般都是通用的，写在全局中比较好</p></blockquote> <p>不是很常用了，因为可以用 methos 和 计算属性代替</p> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Vue<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">'convertTime'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> formatStr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">Moment</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>formatStr<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <blockquote><p>这里有一个坑， 注意写法是一个 |,如果是写2个 ||,过滤方法是进不去的。
| 可以连续使用如 fn | a | b</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code>{{info.add_time | convertTime('YYYY-MM-DD')}}

new Vue({
	filters:{
		convertTime(format){}
	}
})
</code></pre></div><h2 id="继承与混合"><a href="#继承与混合" class="header-anchor">#</a> 继承与混合</h2> <p>混入 (mixin) 提供了一种非常灵活的方式，来分发 Vue 组件中的可复用功能。一个混入对象可以包含任意组件选项。</p> <ul><li>公共方法抽离</li> <li>编写插件</li></ul> <h3 id="vue-mixin"><a href="#vue-mixin" class="header-anchor">#</a> Vue.mixin</h3> <p>返回组件构造器，创建一个子类，参数就是包含组件选项的对象。</p> <p>其中 <code>data</code> 选项由于会被每个组件实例给复用，所以必须是函数，这样每个实例的data指向都是独立的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 为自定义的选项 'myOption' 注入一个处理器。</span>
Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 一般用于写公共的初始化逻辑</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> myOption <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>myOption
    <span class="token keyword">if</span> <span class="token punctuation">(</span>myOption<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myOption<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

	<span class="token comment">// 还可以写一些公共方法</span>
	methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  myOption<span class="token operator">:</span> <span class="token string">'hello!'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// =&gt; &quot;hello!&quot;</span>
</code></pre></div><h3 id="extends-选项"><a href="#extends-选项" class="header-anchor">#</a> extends 选项</h3> <p>用于扩展单文件组件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 混入对象</span>
<span class="token keyword">var</span> mixin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
      foo<span class="token operator">:</span> <span class="token string">'abc'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mixins<span class="token operator">:</span> <span class="token punctuation">[</span>mixin<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 混入</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">'goodbye'</span><span class="token punctuation">,</span>
      bar<span class="token operator">:</span> <span class="token string">'def'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span>
    <span class="token comment">// =&gt; { message: &quot;goodbye&quot;, foo: &quot;abc&quot;, bar: &quot;def&quot; }</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="合并策略"><a href="#合并策略" class="header-anchor">#</a> 合并策略</h3> <p>当组件和混入对象含有同名选项时，这些选项将以恰当的方式进行“合并”。</p> <h4 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h4> <p>同名钩子函数将合并为一个数组，因此都将被调用。</p> <p>另外，混入对象的钩子将在组件自身钩子<strong>之前</strong>调用</p> <h4 id="data-选项"><a href="#data-选项" class="header-anchor">#</a> data 选项</h4> <p>数据对象在内部会进行递归合并，并在发生冲突时以组件数据优先。</p> <h4 id="值为对象的选项"><a href="#值为对象的选项" class="header-anchor">#</a> 值为对象的选项</h4> <p>如 <code>props, methods, computed</code>，将被合并为同一个对象。两个对象键名冲突时，取组件对象的键值对。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ErrorJe/whole-stack-note/edit/master/docs/p5/vue-base/04 Vue 进阶语法.md" target="_blank" rel="noopener noreferrer">编辑文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2/26/2020, 2:40:29 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/whole-stack-note/p5/vue-base/03 Vue 核心语法.html" class="prev">Vue 核心语法</a></span> <span class="next"><a href="/whole-stack-note/p5/vue-base/05 Vue 组件基础.html">Vue 组件基础</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/whole-stack-note/assets/js/app.32c79e15.js" defer></script><script src="/whole-stack-note/assets/js/2.e13c0dfc.js" defer></script><script src="/whole-stack-note/assets/js/74.650ae344.js" defer></script><script src="/whole-stack-note/assets/js/4.006c3239.js" defer></script>
  </body>
</html>
